stages:
  - build
variables:
  CI_REGISTRY:
    description: "Registry for sending images"
    value: "docker.io"
  IMAGE_NAME:
    description: "Tag for docker images"
    value: "zmaalz/reg-forms-app"
  IMAGE_TAG:
    description: "Tag for docker images"
    value: "latest"
  CI_REGISTRY_USER:
    description: "User Registry"
  CI_REGISTRY_PASSWORD:
    description: "Password Registry" 
build:
  stage: build
  image: docker:dind
  services:
    - docker:dind
  before_script:
    - docker info
    - docker login -u "$CI_REGISTRY_USER" -p "$CI_REGISTRY_PASSWORD" $CI_REGISTRY
   script:
    - docker build --pull -t "${IMAGE_NAME}:${IMAGE_TAG}" .
    - docker push "${IMAGE_NAME}:${IMAGE_TAG}"
